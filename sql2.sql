use sakila;

-- q1-Identify the primary keys and foreign keys in maven movies db. Discuss the differences
-- answer 1
describe film;
-- The difference would be primary keys are unique and not null, while foreign keys reference another table's primary key.
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- q2) List all details of actors
select * from actor;
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- q3 -List all customer information from DB.
SELECT * FROM customer;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- q4 -List different countries.
SELECT DISTINCT country FROM country;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

-- q 5 -Display all active customers.
SELECT * FROM customer
where active=1;
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 -- q6 -List of all rental IDs for customer with ID 1.
 SELECT
    rental_id
FROM
    rental
WHERE
    customer_id = 1;
 -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 -- q7 - Display all the films whose rental duration is greater than 5 .
 SELECT
    *
FROM
    film
WHERE
    rental_duration > 5;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 -- q8 - List the total number of films whose replacement cost is greater than $15 and less than $20.
 SELECT
    COUNT(*)
FROM
    film
WHERE
    replacement_cost BETWEEN 16 AND 20;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q9 - Display the count of unique first names of actors.
 SELECT
    COUNT(DISTINCT first_name)
FROM
    actor;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q10- Display the first 10 records from the customer table .
 SELECT
    *
FROM
    customer
LIMIT 10;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q11 - Display the first 3 records from the customer table whose first name starts with ‘b’.
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE 'B%'
LIMIT 3;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 -- q12 -Display the names of the first 5 movies which are rated as ‘G’.
 SELECT
    title
FROM
    film
WHERE
    rating = 'G'
LIMIT 5;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q13-Find all customers whose first name starts with "a".
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE 'A%';
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q14- Find all customers whose first name ends with "a".
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE '%A';
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q15- Display the list of first 4 cities which start and end with ‘a’ .
 SELECT
    city
FROM
    city
WHERE
    city LIKE 'A%A'
LIMIT 4;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q16- Find all customers whose first name have "NI" in any position.
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE '%NI%';
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q17- Find all customers whose first name have "r" in the second position .
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE '_R%';
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q18 - Find all customers whose first name starts with "a" and are at least 5 characters in length.
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE 'A____%';
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q19- Find all customers whose first name starts with "a" and ends with "o".
 SELECT
    *
FROM
    customer
WHERE
    first_name LIKE 'A%A';
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q20 - Get the films with pg and pg-13 rating using IN operator.
 SELECT
    *
FROM
    film
WHERE
    rating IN ('PG', 'PG-13');
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q21 - Get the films with length between 50 to 100 using between operator.
 SELECT
    *
FROM
    film
WHERE
    length BETWEEN 50 AND 100;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q22 - Get the top 50 actors using limit operator.
 SELECT
    *
FROM
    actor
LIMIT 50;
 ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
 -- q23 - Get the distinct film ids from inventory table.
SELECT DISTINCT
    film_id
FROM
    inventory;
